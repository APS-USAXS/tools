<?xml version="1.0"?>


<!-- 

You MUST set EPICS_CA_MAX_ARRAY_BYTES to >= 1280000 to read the maximum
number of data points the MCS can be told to acquire (15iddLAX:3820:MaxChannels).

This is programmed into the Python code that reads this file.
 -->
 
 
<saveFlyData version="1">
  <triggerPV pvname="15iddLAX:USAXSfly:Start" start_value="1" start_text="Busy" done_value="0" done_text="Done" />

  <NX_structure>  <!-- http://download.nexusformat.org/doc/html/classes/base_classes/ -->
    <group name="/" class="file">
      <attribute name="instrument"      value="APS USAXS at 15ID-D" />
      <attribute name="scan_mode"       value="USAXS fly scan" />

      <group name="entry" class="NXentry">
        <PV label="title"     pvname="15iddLAX:USAXS:sampleTitle" />
        <PV label="experiment_identifier"     pvname="15iddLAX:GUPNumber" />
        <PV label="run_cycle"     pvname="15iddLAX:RunCycle" />

		<group name="instrument"      class="NXinstrument">
		
		  <field name="name">
            <attribute name="short_name"      value="USAXS" />
            <text>APS USAXS at 15ID-D</text>
		  </field>
		  <group name="monochromator" class="NXmonochromator">
		    <PV label="DCM_energy"	   pvname="15IDA:BraggERdbkAO" />
		    <PV label="DCM_wavelength"     pvname="15IDA:BraggLambdaRdbkAO" />
		  </group>
		</group>

        <group name="user"       class="NXuser">
          <PV label="name"     pvname="15iddLAX:UserName" />
		</group>

        <group name="sample"     class="NXsample">
          <PV label="name"     pvname="15iddLAX:USAXS:sampleTitle" />
		</group>



        <group name="flyScan" class="NXdata">

          <!-- positioners -->
          <PV label="AR_waypoints" pvname="15iddLAX:traj1:M1Traj"    length_limit="AR_count" />
          <PV label="AR_count"     pvname="15iddLAX:traj1:Nelements" />
          <PV label="AR_pulses"    pvname="15iddLAX:traj1:Npulses" />
          <PV label="AR_start"     pvname="15iddLAX:float11" />  <!-- pushed here by SPEC usaxs_flyscan.txt macro -->
          <PV label="AR_increment" pvname="15iddLAX:USAXS:MinStep" />

          <!-- detectors -->
          <PV label="mca1" pvname="15iddLAX:3820:mca1" length_limit="AR_pulses">		<!-- counts of 50 MHz clock -->
            <attribute name="units"      value="pulses" />
            <attribute name="USAXS_name" value="clock_pulses" />
          </PV>
          <PV label="mca2" pvname="15iddLAX:3820:mca2" length_limit="AR_pulses">
            <attribute name="units"      value="counts" />
            <attribute name="USAXS_name" value="I0" />
          </PV>
          <PV label="mca3" pvname="15iddLAX:3820:mca3" length_limit="AR_pulses">
            <attribute name="signal" value="1" />
            <!-- <attribute name="axes" value="AR" /> -->
	    <!--
	    The proper ordinate is obtained via the MAC channel index:
	    AR[i] = AR_start + AR_increment * i
	    
	    Can the AR array be made available in EPICS?

	    -->
            <attribute name="units"      value="counts" />
            <attribute name="USAXS_name" value="upd" />
          </PV>
          <PV label="mca4" pvname="15iddLAX:3820:mca4" length_limit="AR_pulses">
            <attribute name="units"      value="counts" />
            <attribute name="USAXS_name" value="I00" />
          </PV>
          <PV label="mca_channels"    pvname="15iddLAX:3820:CurrentChannel" />
          <PV label="mca_channel_max" pvname="15iddLAX:3820:MaxChannels" />
		  <PV label="mca1_name"       pvname="15iddLAX:3820:scaler1.NM1" />
		  <PV label="mca2_name"       pvname="15iddLAX:3820:scaler1.NM2" />
		  <PV label="mca3_name"       pvname="15iddLAX:3820:scaler1.NM3" />
		  <PV label="mca4_name"       pvname="15iddLAX:3820:scaler1.NM4" />

          <PV label="time_total" pvname="15iddLAX:traj1:ElapsedTime" />
          <PV label="time_elapsed" pvname="15iddLAX:traj1:Time" />


        </group>		


 	<!-- metadata -->
 	<group name="metadata" class="NXcollection">    <!-- metadata:NXcollection -->
 	  <PV label="SR_current"	 pvname="S:SRcurrentAI" />
 	  <PV label="ID_E"		 pvname="ID15:Energy" />
 	  <PV label="DCM_energy"	 pvname="15IDA:BraggERdbkAO" />
 	  <PV label="DCM_wavelength"	 pvname="15IDA:BraggLambdaRdbkAO" />
 	  <PV label="SPEC_macro_file"	 pvname="15iddLAX:string19" />
 	  <PV label="SPEC_data_file"	 pvname="15iddLAX:USAXS:specFile" />
 	  <PV label="SPEC_data_dir"	 pvname="15iddLAX:USAXS:userDir" />
 	  <PV label="analyzer_distance"  pvname="15iddLAX:USAXS:SAD" />
 	  <PV label="detector_distance"  pvname="15iddLAX:USAXS:SDD" />
 	  <PV label="UATerm"		 pvname="15iddLAX:USAXS:UATerm" />
 	  <PV label="MR_center" 	 pvname="15iddLAX:USAXS:MRcenter" />
 	  <PV label="MSR_center"	 pvname="15iddLAX:USAXS:MSRcenter" />
 	  <PV label="AR_center" 	 pvname="15iddLAX:USAXS:ARcenter" />
 	  <PV label="ASR_center"	 pvname="15iddLAX:USAXS:ASRcenter" />
 	  <PV label="Mirror_T"	 pvname="15IDA:m8.RBV" />
 	  <PV label="Mirror_B"	 pvname="15IDA:m6.RBV" />
 	  <PV label="CryoLoad"	 pvname="15IDCryo:CC01:Power" />
 	  <PV label="gas_pressure_Ni"	 pvname="15IDA:NITROGEN_PRESSURE" />
 	  <PV label="gas_pressure_He"	 pvname="15IDA:HELIUM_PRESSURE" />
 	  <PV label="gas_pressure_Ar"	 pvname="15IDA:ARGON_PRESSURE" />
 	  <PV label="gas_pressure_user"	 pvname="15IDA:USERGAS_PRESSURE" />
	  <!-- need to document the slit positions -->
 	  <PV label="slit_v_center"	 pvname="15iddLAX:m58:c2:m5" />
 	  <PV label="slit_h_center"	 pvname="15iddLAX:m58:c2:m6" />
 	  <PV label="slit_v_gap"	 pvname="15iddLAX:m58:c2:m7" />
 	  <PV label="slit_h_gap"	 pvname="15iddLAX:m58:c2:m8" />
 	</group>

      </group>	     <!-- entry:NXentry -->
    </group>	     <!-- file -->
  </NX_structure>
</saveFlyData>



<!--
########### SVN repository information ###################
# $Date$
# $Author$
# $Revision$
# $URL$
# $Id$
########### SVN repository information ###################
-->
